# ìŠ¤ì½”í”„ì™€ í´ë¡œì €

## Scopeë€?

ë³€ìˆ˜ ì ‘ê·¼ ê·œì¹™ì— ë”°ë¥¸ ìœ íš¨ë²”ìœ„

- ë³€ìˆ˜ëŠ” ì–´ë– í•œ í™˜ê²½ ë‚´ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, í”„ë¡œê·¸ë˜ë° ì–¸ì–´ëŠ” ê°ê°ì˜ ë³€ìˆ˜ ì ‘ê·¼ ê·œì¹™ì„ ê°€ì§
- JavaScriptëŠ” í•¨ìˆ˜ê°€ ì„ ì–¸ë˜ëŠ”(lexical) ë™ì‹œì— ìì‹ ë§Œì˜ Scopeë¥¼ ê°€ì§

```jsx
const f1 = fuction() {
		const a = 1; // í•¨ìˆ˜ ìŠ¤ì½”í”„
		const b = 2;
		console.log(a + b); // 3
    return a + b
}

let a = 20; // aëŠ” ì „ì—­ ë³€ìˆ˜
console.log(b); // error: b is not defined
// í•¨ìˆ˜ ë‚´ì—ì„œ ì„ ì–¸ëœ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ê°€ ì¢…ë£Œë¨ê³¼ ë™ì‹œì— ì‚¬ë¼ì§

f1()
```

- ìŠ¤ì½”í”„ëŠ” ë³€ìˆ˜ì´ë¦„ì´ ì¶©ëŒí•˜ëŠ” ë¬¸ì œë¥¼ ëœì–´ì£¼ê³ , ìë™ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ ê´€ë¦¬ í•¨

## Scopeì˜ ì¢…ë¥˜

- **ì „ì—­ ìŠ¤ì½”í”„ì™€ ì§€ì—­ ìŠ¤ì½”í”„**
    - ì „ì—­ ìŠ¤ì½”í”„(Global Scope)
    ìŠ¤í¬ë¦½íŠ¸ ì „ì²´ì—ì„œ ì°¸ì¡°ë˜ëŠ” ê²ƒì„ ì˜ë¯¸, ì–´ëŠ ê³³ì—ì„œë“  ì°¸ì¡° ê°€ëŠ¥
    - ì§€ì—­ ìŠ¤ì½”í”„(Local Scope)
    ì •ì˜ëœ í•¨ìˆ˜ ë‚´ì—ì„œë§Œ ì°¸ì¡°ë˜ëŠ” ê²ƒì„ ì˜ë¯¸, í•¨ìˆ˜ ë°–ì—ì„œëŠ” ì°¸ì¡°ë˜ì§€ ì•ŠìŒ
    
- **ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ìœ íš¨ ë²”ìœ„**
    - ì „ì—­ ìŠ¤ì½”í”„
    - í•¨ìˆ˜ ìŠ¤ì½”í”„ (ì§€ì—­ ìŠ¤ì½”í”„)
    - ë¸”ë¡ ìŠ¤ì½”í”„ (ES6ì—ì„œ ë“±ì¥ let, const) (ì§€ì—­ ìŠ¤ì½”í”„)
    
- **ì „ì—­ ìŠ¤ì½”í”„**
    
    ìŠ¤í¬ë¦½íŠ¸ ì „ì²´ì—ì„œ ì°¸ì¡°ë˜ëŠ” ê²ƒì„ ì˜ë¯¸, ì–´ëŠ ê³³ì—ì„œë“  ì ‘ê·¼ ê°€ëŠ¥
    
    íƒ€ì¸ê³¼ í˜‘ì—…, ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì‹œ ì¶©ëŒì´ ê°€ëŠ¥ì„± ìˆìŒ â†’ ë³€ìˆ˜ëª…ì´ë‚˜ í•¨ìˆ˜ëª…ì´ ê²¹ì¹  ìš°ë ¤
    ì „ì—­ ìŠ¤ì½”í”„ì—ì„œ ë³€ìˆ˜ë‚˜ í•¨ìˆ˜ë¥¼ ì„ ì–¸í•˜ëŠ” ê²ƒì€ ìì œí•´ì•¼í•¨
    
- **í•¨ìˆ˜ ìŠ¤ì½”í”„**
    
    í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì •ì˜ëœ ë³€ìˆ˜ì™€ ë§¤ê°œë³€ìˆ˜ëŠ” í•¨ìˆ˜ ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ
    
    í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì •ì˜ëœ í•¨ìˆ˜ë¼ë©´ í•¨ìˆ˜ì˜ ì–´ëŠ ë¶€ë¶„ì—ì„œë„ ì ‘ê·¼í•  ìˆ˜ ìˆìŒ
    

```jsx
const func = function() {
		let a = 1;
		let b = 2;
		
		const func2 = function() {
		let b = 5;
		let c = 6;
		a = a + b + c; // 1 + 5 + 6
		console.log(a) // 12
		}
		func2();
		console.log(a); // 12
}
func();
```

- func2ì—ì„œ aë¼ëŠ” ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œ ì ì´ ì—†ì§€ë§Œ, funcë¼ëŠ” ë¶€ëª¨í•¨ìˆ˜ ì•ˆì—ì„œ ì„ ì–¸ëœ í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ë¶€ëª¨ í•¨ìˆ˜ì—ì„œ ì„ ì–¸ëœ ë³€ìˆ˜ë¥¼ ì°¸ì¡° ê°€ëŠ¥í•¨ â†’ **í•¨ìˆ˜ì˜ ì¤‘ì²©**

## Scope Chain (í•¨ìˆ˜ì˜ ì¤‘ì²©)

ë‚´ë¶€í•¨ìˆ˜ì—ì„œëŠ” ì™¸ë¶€í•¨ìˆ˜ì˜ ë³€ìˆ˜ì— ì ‘ê·¼ ê°€ëŠ¥í•˜ì§€ë§Œ, ì™¸ë¶€í•¨ìˆ˜ì—ì„œëŠ” ë‚´ë¶€í•¨ìˆ˜ì˜ ë³€ìˆ˜ì— ì ‘ê·¼ ë¶ˆê°€ëŠ¥

![Untitled](%E1%84%89%E1%85%B3%E1%84%8F%E1%85%A9%E1%84%91%E1%85%B3%E1%84%8B%E1%85%AA%20%E1%84%8F%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A9%E1%84%8C%E1%85%A5%2068215bd7fd9047b8939987545b573fc0/Untitled.png)

```jsx
var name = 'scope';
function outer() {
		console.log('ì™¸ë¶€í•¨ìˆ˜', name);
		function inner() {
		    var friend = 'Chain';
				console.log('ë‚´ë¶€í•¨ìˆ˜', name);
    }
		inner();
}
outer();
console.log(friend); // ì–´ë–»ê²Œ ì¶œë ¥ë ê¹Œ?
```

1. inner í•¨ìˆ˜ëŠ” name ë³€ìˆ˜ë¥¼ ì°¾ê¸° ìœ„í•´ ë¨¼ì € ìê¸° ìì‹ ì˜ ìŠ¤ì½”í”„ì—ì„œ ì°¾ìŒ
2. ì´ì— í•´ë‹¹í•˜ëŠ” ê²ƒì´ ì—†ìœ¼ë©´ í•œ ë‹¨ê³„ ì˜¬ë¼ê°€ outer ìŠ¤ì½”í”„ì—ì„œ ë³€ìˆ˜ë¥¼ ì°¾ìŒ
3. outerìŠ¤ì½”í”„ì—ë„ ì—†ë‹¤ë©´ ë‹¤ì‹œ ì˜¬ë¼ê°€ ì „ì—­ ìŠ¤ì½”í”„ì—ì„œ ì°¾ìŒ
    
    ë§Œì•½ ì „ì—­ ìŠ¤ì½”í”„ì—ë„ ì—†ë‹¤ë©´ ë³€ìˆ˜ë¥¼ ì°¾ì§€ ëª»í–ˆë‹¤ëŠ” ì—ëŸ¬ ë°œìƒ
    

ğŸ“Œ ì´ì²˜ëŸ¼ ìŠ¤ì½”í”„ê°€ ê³„ì¸µì ìœ¼ë¡œ ì—°ê²°ë˜ìˆëŠ” ê²ƒì„ **ì¤‘ì²© ê·œì¹™** í˜¹ì€ **ìŠ¤ì½”í”„ ì²´ì¸**ì´ë¼ê³  ë¶€ë¦„

- **ë¸”ë¡ ìŠ¤ì½”í”„**
    
    ì¤‘ê´„í˜¸ {...} ì•ˆì—ì„œë§Œ ì ‘ê·¼ì´ ê°€ëŠ¥í•¨. ë¸”ë¡ ë‚´ë¶€ì— ì •ì˜ëœ ë³€ìˆ˜ëŠ” ë¸”ë¡ ì‹¤í–‰ì´ ëë‚˜ë©´ í•´ì œë¨
    
    ES6 ì´í›„, let í‚¤ì›Œë“œë¥¼ ì“°ë©´ block scope ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
    
    ```jsx
    if (true) {
    		var value = "hello";
    }
    console.log(value); // "hello"
    ```
    
    ```jsx
    if (true) {
    		let value = "world";
    }
    console.log(value); // undefined
    ```
    
    ```jsx
    if (true) {
    	var value = "hello";
    }
    console.log(value); // "hello"
    
    if (true) {
    	let value = "world"; // let, constëŠ” ì¤‘ê´„í˜¸ ì•ˆì—ì„œë§Œ ìœ íš¨ ë²”ìœ„ë¥¼ ê°–ëŠ”ë‹¤
    }
    console.log(value); // "hello"
    ```
    

**Q. ì½˜ì†”ì— ì¶œë ¥ë˜ëŠ” ê²°ê³¼ëŠ”?**

```jsx
function foo() {
  x = 1;
  let y = 2;
}

foo();

console.log(x);
console.log(y);
```

## ì•”ë¬µì  ì „ì—­ (implied globals)

    ëª…ì‹œì ìœ¼ë¡œ ë³€ìˆ˜ ì•ì— letì„ ë¶™ì—¬ì£¼ì§€ ì•Šìœ¼ë©´ ì•”ë¬µì  ì „ì—­ë³€ìˆ˜ê°€ ë¨
    ë”°ë¼ì„œ xëŠ” 1, yëŠ” Reference Error ë°œìƒ

    â†’ ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ **use strict** ì‚¬ìš©

```jsx
function showAge() {
		age = 27;
		console.log(age);
}
showAge();
console.log(age);

// age === window.age
// ì„ ì–¸ì—†ì´ ë³€ìˆ˜ë¥¼ í• ë‹¹í•˜ë©´, ì „ì—­ë³€ìˆ˜ê°€ ë˜ì–´ window ê°ì²´ì™€ ì—°ê²°ë¨
```

## ì •ì  ìŠ¤ì½”í”„ (lexical scoping)

í•¨ìˆ˜ ë‚´ì—ì„œ ì„ ì–¸ëœ ë³€ìˆ˜ì˜ scopeëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë•Œê°€ ì•„ë‹ˆë¼ **ì„ ì–¸í•  ë•Œ ê²°ì •**

(í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì— ê²°ì • â†’ ë™ì  ìŠ¤ì½”í”„)

```jsx
// ì˜ˆì œ 1
var a = 1;
var func = function () {
		console.log(a);
}
var func2 = function () {
		var a = 2;
		func();
}
func2();
```

```jsx
// ì˜ˆì œ 2
var a = 1;
var func2 = function () {
		var a = 2;
		var func = function () {
				console.log(a);				
		}
		func();
}
func2();
```

- í•¨ìˆ˜ë¥¼ ì„ ì–¸í•˜ëŠ” ìˆœê°„, í•¨ìˆ˜ ë‚´ë¶€ì˜ ë³€ìˆ˜ëŠ” ìê¸° ìŠ¤ì½”í”„ë¡œë¶€í„° ê°€ì¥ ê°€ê¹Œìš´ ê³³ (ìƒìœ„ ë²”ìœ„ì—ì„œ)ì— ìˆëŠ” ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•˜ê²Œ ë¨
- ì˜ˆì œ 1ì˜ ê²½ìš°, func()ì˜ ë¶€ëª¨ í•¨ìˆ˜ëŠ” ì „ì—­ ê°ì²´ì¸ windowì´ê¸° ë•Œë¬¸ì— 1ì´ ì¶œë ¥ë¨
- ì˜ˆì œ 2ì˜ ê²½ìš°, func()ê°€ func2() ì•ˆì—ì„œ ì„ ì–¸ëìœ¼ë¯€ë¡œ 2ê°€ ì¶œë ¥ë¨

## í´ë¡œì € (Closer)

í´ë¡œì €ëŠ” í•¨ìˆ˜ê°€ ì„ ì–¸ëœ í™˜ê²½ì˜ (ë ‰ì‹œì»¬) ìŠ¤ì½”í”„ë¥¼ ê¸°ì–µí•˜ì—¬ í•¨ìˆ˜ê°€ ìŠ¤ì½”í”„ ë°–ì—ì„œ ì‹¤í–‰ë  ë•Œì—ë„ ì´ ìŠ¤ì½”í”„ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê¸°ìˆ 

- **í´ë¡œì € ìƒì„± ì¡°ê±´**
1. ë‚´ë¶€í•¨ìˆ˜ê°€ ìµëª…í•¨ìˆ˜ë¡œ ë˜ì–´ ì™¸ë¶€í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.
2. ë‚´ë¶€í•¨ìˆ˜ëŠ” ì™¸ë¶€í•¨ìˆ˜ì˜ ì‹¤í–‰í™˜ê²½ì—ì„œ ì‹¤í–‰ëœë‹¤.
3. ë‚´ë¶€í•¨ìˆ˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ xëŠ” ì™¸ë¶€í•¨ìˆ˜ì˜ ë³€ìˆ˜ ìŠ¤ì½”í”„ì— ìˆë‹¤.

```jsx
function outer() {
  var name = `closure`;
  function inner() {
    console.log(name);
  }
  inner();
}
outer();
// console> closure
```

```jsx
var name = `Warning`;
function outer() {
  var name = `closure`;
  return function inner() {
    console.log(name);
  };
}

var callFunc = outer();
callFunc();
// console> closure

// callFunc: í´ë¡œì €
```

callFunc í˜¸ì¶œì— ì˜í•´ nameì´ë¼ëŠ” ê°’ì´ consoleì— Warningì´ ì•„ë‹ˆë¼ closureê°€ ì¶œë ¥ ë¨
ì¦‰, outer í•¨ìˆ˜ì˜ context ì— ì†í•´ìˆëŠ” ë³€ìˆ˜ë¥¼ ì°¸ì¡°í•˜ëŠ” ê²ƒì´ë‹¤. ì—¬ê¸°ì„œ outerí•¨ìˆ˜ì˜ ì§€ì—­ë³€ìˆ˜ë¡œ ì¡´ì¬í•˜ëŠ” nameë³€ìˆ˜ë¥¼ free variable(ììœ ë³€ìˆ˜)ë¼ê³  í•¨

â†’ ì™¸ë¶€í•¨ìˆ˜ í˜¸ì¶œì´ ì¢…ë£Œë˜ë”ë¼ë„ ì™¸ë¶€ í•¨ìˆ˜ì˜ ì§€ì—­ë³€ìˆ˜ ë° ë³€ìˆ˜ ìŠ¤ì½”í”„ ê°ì²´ì˜ ì²´ì¸ ê´€ê³„ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¥¼ í´ë¡œì €ë¼ í•¨. ì™¸ë¶€ í•¨ìˆ˜ì— ì˜í•´ ë°˜í™˜ë˜ëŠ” ë‚´ë¶€ í•¨ìˆ˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§

### í´ë¡œì € í™œìš©

```jsx
// counterëŠ” outer í•¨ìˆ˜
// changeCountëŠ” innerí•¨ìˆ˜
// ê°ì²´ë¥¼ ë¦¬í„´í•˜ê³  ìˆê³  ê°ì²´ ì•ˆì—ëŠ” increase, decrease, showì™€ ê°™ì€ innerí•¨ìˆ˜ë“¤ì„ ì €ì¥
const counter = function() {
  let count = 0;
  function changeCount(number) {
    count += number;
  }
  return {
    increase: function() {
      changeCount(1);
    },
    decrease: function() {
      changeCount(-1);
    },
    show: function() {
      alert(count);
    }
  }
};

// counterë¥¼ ì‹¤í–‰í•˜ë©´ outerí•¨ìˆ˜ ìŠ¤ì½”í”„ë¥¼ ê¸°ì–µí•˜ê³  ìˆëŠ” í´ë¡œì €ë“¤ì´ ë‹´ê¸´ ê°ì²´ë¥¼ ë°˜í™˜
// counterClosureëŠ” counterí•¨ìˆ˜ ë‚´ë¶€ì— ì •ì˜ëœ countë‚˜ changeCountì— ì ‘ê·¼ ê°€ëŠ¥

const counterClosure = counter(); 
counterClosure.increase(); // 
counterClosure.show(); // 1
counterClosure.decrease();
counterClosure.show(); // 0
```

ë‚´ë¶€í•¨ìˆ˜ëŠ” ì™¸ë¶€í•¨ìˆ˜ì˜ ë³€ìˆ˜ì— ì ‘ê·¼ í•  ìˆ˜ ìˆëŠ”ë°, ì™¸ë¶€í•¨ìˆ˜ì˜ ì‹¤í–‰ì´ ëë‚˜ì„œ ì™¸ë¶€í•¨ìˆ˜ê°€ ì†Œë©¸ëœ ì´í›„ì—ë„ ë‚´ë¶€í•¨ìˆ˜ê°€ ì™¸ë¶€í•¨ìˆ˜ì˜ ë³€ìˆ˜ì— ì ‘ê·¼ í•  ìˆ˜ ìˆìŒ

â†’ ì´ëŸ¬í•œ ë§¤ì»¤ë‹ˆì¦˜ì„ **í´ë¡œì €**ë¼ í•¨
